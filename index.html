<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game Suit Jawa</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="normalize.css">
    <link rel="stylesheet" href="css/bootstrap.min.css">
</head>

<body>
    <div class="wrap-section">
        <div class="judul">
            <h1>Selamat Datang di Game Suit Jawa!</h1>
            <a href="#hasil" class="sub-judul">Uji Keberuntunganmu!</a>
        </div>

        <div class="game">
            <div class="wrap-tentukan">
                <div id="pilihan">Pilih!</div>
                <br>
            </div>

            <div class="button-pilihan">
                <button type="button" id="batu" class="tombol-pilih">Batu</button>
                <button type="button" id="gunting" class="tombol-pilih">Gunting</button>
                <button type="button" id="kertas" class="tombol-pilih">Kertas</button>
                <button class="click">Main!</button>
            </div>

            <div class="container">
                <div id="hasil">Arena Pertarungan</div>
                <div class="row">
                    <div class="col-md-4 col-xs 12">
                        <div class="comp-side">
                            <p>Komputer</p>
                            <img src="img/computer.png" class="komp" alt="">
                        </div>
                    </div>
                    <div class="col-md-4 hidden-sm hidden-xs">
                        <div class="vs">
                            <h2>VS</h2>
                        </div>
                    </div>
                    <div class="col-md-4 hidden-sm hidden-xs">
                        <div class="player-side">
                            <p>Anda</p>
                            <img src="img/orang.jpg" class="orang" alt="">
                        </div>
                    </div>
                </div>
                <br>

                <button id="lagi">RESET</button>
            </div>
        </div>
    </div>

    <script src="jquery-3.4.1.min.js"></script>
    <script src="bootstrap.min.js"></script>
    <script>
        let hasil = document.getElementById("hasil");
        let gambarKomp = document.getElementsByClassName("komp")[0];
        // Menangkap pilihan player
        let gp = document.getElementsByClassName("orang")[0];
        let p = document.querySelectorAll(".tombol-pilih");
        let layar = document.getElementById("pilihan");
        
        for(let i=0; i < p.length; i++) {
            p[i].onclick = function() {
                btnVal = this.innerHTML;

                if (btnVal == "Batu") {
                    gp.src = "img/batu.png";
                    layar.innerHTML = "Anda memililh BATU";
                    player = "batu";
                }
                else if (btnVal == "Gunting") {
                    gp.src = "img/gunting.png";
                    layar.innerHTML = "Anda memilih GUNTING";
                    player = "gunting"
                }
                else {
                    gp.src = "img/kertas.png";
                    layar.innerHTML = "Anda memilih KERTAS";
                    player = "kertas";
                };
            };
        };

        // Function mengacak gambar komputer
        function putar() {
            const gambar = ['batu', 'gunting', 'kertas'];
            let i = 0;
            const waktuAwal = new Date().getTime(); 
            setInterval(function() {
                if(new Date().getTime() - waktuAwal > 1000) {
                    clearInterval;
                    return;
                }
                gambarKomp.setAttribute('src', 'img/' + gambar[i++] + '.png');
                if(i == gambar.length) i = 0;
            }, 90);
        }
        
        function game() {
            // Jalankan fungsi putar
            putar();
            // Tunggu sampai fungsi putar selesai, lalu jalankan:
            setTimeout(function() {
                // Menangkap pilihan komputer
                    // Membangkitkan bilangan random
                let comp = Math.random();

                if (comp < 0.34) {
                    comp = "batu";
                    gambarKomp.src = "img/batu.png";
                } else if (comp >= 0.34 && comp < 0.67) {
                    comp = "gunting";
                    gambarKomp.src = "img/gunting.png";
                } else {
                    comp = "kertas";
                    gambarKomp.src = "img/kertas.png";
                }

                // Rules
                if (player == comp) {
                    hasil.innerHTML = "Pertarungan SERI!";
                } else if (player == "batu") {
                    if (comp == "gunting") {
                        hasil.innerHTML = "Anda MENANG!!";
                    } else {
                        hasil.innerHTML = "Anda KALAH!!";
                    }
                } else if (player == "gunting") {
                    if (comp == "kertas") {
                        hasil.innerHTML = "Anda MENANG!!";
                    } else {
                        hasil.innerHTML = "Anda KALAH!!";
                    }
                } else {
                    if (comp == "batu") {
                        hasil.innerHTML = "Anda MENANG!!";
                    } else {
                        hasil.innerHTML = "Anda KALAH!!";
                    }
                }
            }, 1000);    
        }

        //Tampilkan hasilnya
        const tombolPlay = document.querySelector('.button-pilihan .click');
        tombolPlay.addEventListener('click', function() {
            game();
        });

        // Reset Button
        const resetBtn = document.getElementById('lagi');
        resetBtn.addEventListener('click', function() {
            document.location.reload(true);
        });
    </script>
</body>

</html>